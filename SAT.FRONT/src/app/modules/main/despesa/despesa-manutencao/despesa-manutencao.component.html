<mat-drawer-container class="flex-auto h-full" *transloco="let t">
    <mat-drawer-content>
        <div
            class="sm:absolute sm:inset-0 flex flex-col flex-auto min-w-0 sm:overflow-hidden bg-card dark:bg-transparent">
            <div class="relative flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between py-7 px-6 md:px-8
                border-b">
                <div class="absolute inset-x-0 bottom-0" *ngIf="isLoading">
                    <mat-progress-bar [mode]="'indeterminate'"></mat-progress-bar>
                </div>
                <div class="flex flex-auto items-center min-w-0">
                    <div class="flex-1 min-w-0">
                        <div class="flex flex-wrap items-center font-medium">
                            <div>
                                <a class="whitespace-nowrap text-primary-500" routerLink="/despesa/atendimentos">
                                    {{ t('atendimentos') }}
                                </a>
                            </div>

                            <div class="flex items-center ml-1 whitespace-nowrap">
                                <mat-icon class="icon-size-5 text-secondary"
                                    [svgIcon]="'heroicons_solid:chevron-right'"></mat-icon>
                                <span class="ml-1 text-secondary">{{ t('relatorio') }}</span>
                            </div>
                            <div class="flex items-center ml-1 whitespace-nowrap">
                                <mat-icon class="icon-size-5 text-secondary"
                                    [svgIcon]="'heroicons_solid:chevron-right'"></mat-icon>
                                <span class="ml-1 text-secondary">{{ codRAT }}</span>
                            </div>
                            <div class="flex items-center ml-1 whitespace-nowrap">
                                <mat-icon class="icon-size-5 text-secondary"
                                    [svgIcon]="'heroicons_solid:chevron-right'"></mat-icon>
                                <span class="ml-1 text-secondary">{{ t('despesas') }}</span>
                            </div>
                        </div>
                        <div class="text-3xl mt-2 md:text-4xl font-extrabold tracking-tight leading-7 sm:leading-10
                                truncate">
                            {{ 'Consulta de Despesas' }}
                        </div>
                        <div class="mt-2">
                            <div class="text-base font-semibold text-secondary tracking-tight" *ngIf="!isLoading">
                                {{ "OS " + rat?.codOS }} {{ " - " + ordemServico?.cliente?.nomeFantasia + ", " }}
                                {{ ordemServico?.cliente?.numBanco || '---' }}
                                {{ ordemServico?.localAtendimento?.numAgencia || '---' }}/{{ ordemServico?.localAtendimento?.dcPosto || '---' }}
                            </div>
                            <div class="text-base font-semibold text-secondary tracking-tight" *ngIf="!isLoading">
                                {{  ordemServico?.localAtendimento?.endereco + ' - ' + ordemServico?.localAtendimento?.cidade?.nomeCidade + ' - ' + ordemServico?.localAtendimento?.cidade?.unidadeFederativa?.siglaUF || 'não informado' }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex flex-col flex-auto p-6 bg-card rounded-2xl overflow-auto">
                <div class="flex items-center justify-between" *ngIf="!isLoading">
                    <div class="text-2xl font-extrabold tracking-tight"> {{ t('despesas') | uppercase }}</div>
                    <button class="ml-4" mat-icon-button (click)="lancarDespesaItem()">
                        <mat-icon class="text-green-500" [svgIcon]="'heroicons_outline:plus-circle'"></mat-icon>
                    </button>
                </div>
                <div class="flex justify-center align-middle items-center" *ngIf=" isDespesaLoading && !isLoading">
                    <mat-progress-spinner diameter="50" [mode]="'indeterminate'"></mat-progress-spinner>
                </div>
                <div class="flex flex-col fuse-mat-dense my-2 max-h-screen overflow-auto"
                    *ngIf="despesaItens.length > 0 && !isDespesaLoading">
                    <table mat-table [dataSource]="despesaItens" class="mat-elevation-z4">

                        <ng-container matColumnDef="acao">
                            <th mat-header-cell *matHeaderCellDef> {{ t('acao') }} </th>
                            <td mat-cell *matCellDef="let di" class="text-sm"> {{ "--" }} </td>
                        </ng-container>

                        <ng-container matColumnDef="despesaTipo">
                            <th mat-header-cell *matHeaderCellDef> {{ t('tipo') }} </th>
                            <td mat-cell *matCellDef="let di" class="text-sm"> {{ di.despesaTipo?.nomeTipo }} </td>
                        </ng-container>

                        <ng-container matColumnDef="numNF">
                            <th mat-header-cell *matHeaderCellDef> {{ t('nf') }} </th>
                            <td mat-cell *matCellDef="let di" class="text-sm"> {{ di.numNF ?? "---" }} </td>
                        </ng-container>

                        <ng-container matColumnDef="quilometragem">
                            <th mat-header-cell *matHeaderCellDef> {{ t('quilometragem') }} </th>
                            <td mat-cell *matCellDef="let di" class="text-sm">
                                {{ di.kmPercorrido != 0 &&  di.kmPercorrido != null ? di.kmPercorrido +"km" : "---" }}
                            </td>
                        </ng-container>

                        <ng-container matColumnDef="valorTotal">
                            <th mat-header-cell *matHeaderCellDef> {{ t('valor total') }} </th>
                            <td mat-cell *matCellDef="let di" class="text-sm">
                                {{ di.despesaValor | currency:'BRL':'symbol-narrow' }}
                            </td>
                        </ng-container>

                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                    </table>
                </div>
                <div *ngIf="!despesaItens.length && !isLoading"
                    class="p-8 sm:p-16 border-t fuse-mat-dense text-2xl font-semibold tracking-tight text-center">
                    Nenhuma despesa lançada até o momento.</div>
            </div>
        </div>
    </mat-drawer-content>
</mat-drawer-container>